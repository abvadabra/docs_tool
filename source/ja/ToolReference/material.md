
# マテリアル

## 概要

専用のツール（マテリアルエディタ）でEffekseerで使用するマテリアルを作成します。
マテリアルでは、パーティクルの描画の仕方を指定します。

マテリアルエディタではノードを使用して計算式を記述できます。
その計算の結果がパーティクルとして表示されます。

TODO：図

マウスの左のドラッグでノードの入力と出力を接続できます。

右クリックで表示されるメニューから新規のノードに接続できます。

TODO:図

最も簡単な構成は、定数3と出力の2つのノードです。

定数3では、値を3つ指定できます。
出力では、最終的に出力される値を受け取ります。

出力のEmissiveの入力ピンと、定数3の出力ピンを接続します。

そうすると、パーティクルに定数3の値が表示されます。

TODO : 図

## 詳細な操作方法

### ノードの移動

左クリックで選択した後、左のドラッグで移動できます。

### ノードの検索

画面を右クリックしたメニューにキーワードを入力すると、そのキーワードが含まれるノードのみが表示されます。
キーワードはマウスオーバーで確認できます。

TODO : 図

### ノード、線の削除

左クリックで選択し、右クリックを押すと削除がメニューに表示されます。
削除を選択するとノード、線を削除できます。

TODO : 図

### パラメーターの説明

パラメーターには概要と説明を記述できます。
この概要と説明はEffekseerに表示されます。
わかりやすく説明を書くことを推奨します。

### ショートカット

Ctrl + Z - UNDO
Ctrl + ? - REDO
Ctrl + C - Copy
Ctrl + V - 貼り付け
Ctrl + S - 上書き保存

## ライティングについて

マテリアルの出力ノードでライティングをするか、しないかを選択できます。

TODO : 図

## 入出力の値の種類について

数値と画像の2種類があります。
マテリアルの数値は1～4つの数値で構成されています。
多くの場合、数値は要素数が異なっても接続できます。
画像は画像としか接続できません。

本ドキュメントでは、要素数に応じて数値1～数値4と呼びます。

## ノード

マテリアルエディタには様々なノードがあります。

### 出力

最終的に出力される値を設定できます。

出力では、ライティングの種類を設定できます。

現在、ライティングにはLit、とUnlitがあります。
Litを設定すると、光源の影響を受けるようになります。
Unlitを設定すると、入力された値を表示します。

TODO : 画像

#### BaseColor (数値3)

Litの場合のみ有効です。マテリアルの色を入力します。

#### Emissive (数値3)

マテリアルの発光する色を入力します。
Unlitの場合、表示する色を入力します。

#### Alpha (数値1)

透明度を入力します。

#### Mask (数値1)

マスクを入力します。0以下の場合、全く表示されなくなります。

#### Roughness (数値1)

Litの場合のみ有効です。面の粗さを入力します。

#### Normal (数値3)

Litの場合のみ有効です。法線の方向を入力します。

#### WorldPositionOffset (数値3)

頂点の移動距離を入力します。

#### Refraction (数値1)

屈折率を入力します。屈折率が1の場合、屈折しません。
屈折率が1出ない場合、背景を屈折して入力します。
1以上の値を入力します。

### 定数1、2、3、4 (Constant1,2,3,4)

プロパティに指定された値を出力します。

### パラメーター1、4 (Parameter1,Parameter4)

外部から設定されたパラメーターを出力します。
このパラメーターはノード単位で共通です。
パラメーターに設定された概要と詳細はEffekseerや外部のツールに表示されます。

TODO:図

### カスタムデータ1、2 (CustomData1、CustomData2)

外部から設定されたパラメーターを出力します。
このパラメーターはパーティクルごとに異なる値を設定できます。
パラメーターに設定された概要と詳細はEffekseerや外部のツールに表示されます。

TODO:図

### Abs

入力された値の絶対値を出力します。

### Sine

入力された値のSineを出力します。

### Arctangent2

入力された値のArctangentを出力します。

### 足し算(Add)

入力された2つの値を足した結果を出力します。
入力が接続されてない場合、プロパティの値を使用します。

### 引き算(Subtract)

入力された2つの値を引いた結果を出力します。
入力が接続されてない場合、プロパティの値を使用します。

### 掛け算(Multiply)

入力された2つの値を掛けた結果を出力します。
入力が接続されてない場合、プロパティの値を使用します。


### 割り算(Divide)

入力されたValue1をValue2で割った結果を出力します。
入力が接続されてない場合、プロパティの値を使用します。

### あまり(FMod)

入力されたValue1をValue2で割った結果を出力します。
入力が接続されてない場合、プロパティの値を使用します。

### 切り上げ(Ceil)

入力されたValueを切り上げた値を出力します。

### 切り下げ(Floor)

入力されたValueを切り下げた値を出力します。

### 小数部(Frac)

入力されたValueの少数部を出力します。

例:

1.14 -> 0.14

### 最大(Max)

入力されたValue1とValue2で大きい値を出力します。

### 最小(Min)

入力されたValue1とValue2で小さい値を出力します。

### 畳数(Power)

A(TODO)をB乗した値を出力します。

### ルート(SquareRoot)

A^-2を出力します。

### クランプ(Clamp)

AをB-Cの間に収めた値を出力します。

### 内積(DotProduct)

AとBの内積を計算します。

### 外積(CrossProduct)

AとBの外積を計算します。

### 線形補間(LinearInterpolate)

AとBの間をCの割合で補完した値を出力します。

Cが1だったらAを出力します。
Cが0だったらBを出力します。
Cが0.7だったらA*0.3+B*0.7を出力します。

### 1-x (OneMinus)

1 - x を出力します。

### 要素抽出 (ComponentMask)

Aから要素を抽出します。
例えば、数値4の一部を抽出して、数値2を出力します。

### 要素結合 (AppendVector)

AとBの要素を結合します。
例えば、数値3と数値1を入力して、数値4を出力します。

### UV座標 (TextureCoordinate)

パーティクルのUV座標を出力します。

### 移動UV座標 (Panner)

パーティクルのUV座標を時間に応じて移動させて出力します。

### 画像 (TextureObject)

指定した画像を出力します。
画像なので直接、表示はできません。

### 画像パラメーター (TextureObjectParameter)

外部から指定した画像を出力します。
画像なので直接、表示はできません。

### 画像参照 (SampleTexture)

画像から画素を取得します。

### 時間 (Time)

現在の時間を秒単位で取得します。

### 法線(頂点) (VertexNormalWS)

頂点の法線を出力します。

### 法線(画素) (PixelNormalWS)

法線マップ等により、画素ごとに法線の方向が変更された後の法線を出力します。

### 頂点カラー (VertexColor)

頂点カラーを出力します。

### コメント (Comment)

わかりやすくするためのコメントです。動作には影響しません。

## 計算の挙動の詳細

Value1とValue2の入力がある場合、Value2にはValue1と同じ種類の値かFloat1を入力できます。
Value1とValue2の種類が同じ場合、それぞれの要素同士で計算した結果を出力します。

Value2がFloatの場合、Value1の各要素とValue2を計算した結果を出力します。
